/**
 * wax - 7.0.0dev13 - v6.0.4-142-ga157a2d
 */
wax=wax||{};wax.mm=wax.mm||{};wax._={};wax.mm.bwdetect=function(b,a){a=a||{};var f=a.jpg||".jpg70";wax._.bw_png=a.png||".png128";wax._.bw_jpg=f;return wax.bwdetect(a,function(a){wax._.bw=!a;for(a=0;a<b.layers.length;a++)b.getLayerAt(a).provider instanceof wax.mm.connector&&b.getLayerAt(a).setProvider(b.getLayerAt(a).provider)})};wax.mm.interaction=function(){function b(){a=!0}var a=!1,f,d,e="zoomed panned centered extentset resized drawn".split(" ");return wax.interaction().attach(function(a){if(!arguments.length)return d;d=a;for(var c=0;c<e.length;c++)d.addCallback(e[c],b)}).detach(function(){for(var a=0;a<e.length;a++)d.removeCallback(e[a],b)}).parent(function(){return d.parent}).grid(function(){if(a||!(void 0!==f&&f.length)){for(var b,c=0;c<d.getLayers().length;c++){var g=d.getLayerAt(c).levels,g=g&&g[Math.round(d.zoom())];if(void 0!==g&&(b=d.getLayerAt(c).tileElementsInLevel(g),b.length))break}var c=[],h;for(h in b)if(b.hasOwnProperty(h)&&b[h].parentNode===g){var e=wax.u.offset(b[h]);c.push([e.top,e.left,b[h]])}f=c}return f})};wax.mm._provider=function(b){this.options={tiles:b.tiles,scheme:b.scheme||"xyz",minzoom:b.minzoom||0,maxzoom:b.maxzoom||22,bounds:b.bounds||[-180,-90,180,90]}};wax.mm._provider.prototype={outerLimits:function(){return[this.locationCoordinate(new MM.Location(this.options.bounds[0],this.options.bounds[1])).zoomTo(this.options.minzoom),this.locationCoordinate(new MM.Location(this.options.bounds[2],this.options.bounds[3])).zoomTo(this.options.maxzoom)]},getTile:function(b){var a;if(!(a=this.sourceCoordinate(b))||a.zoom<this.options.minzoom||a.zoom>this.options.maxzoom)return null;a.row="tms"===this.options.scheme?Math.pow(2,a.zoom)-a.row-1:a.row;b=this.options.tiles[parseInt(Math.pow(2,a.zoom)*a.row+a.column,10)%this.options.tiles.length].replace("{z}",a.zoom.toFixed(0)).replace("{x}",a.column.toFixed(0)).replace("{y}",a.row.toFixed(0));wax._&&wax._.bw&&(b=b.replace(".png",wax._.bw_png).replace(".jpg",wax._.bw_jpg));return b}};MM&&MM.extend(wax.mm._provider,MM.MapProvider);wax.mm.connector=function(b){b=new wax.mm._provider(b);return new MM.Layer(b)};